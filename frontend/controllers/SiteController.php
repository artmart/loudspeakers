<?php
namespace frontend\controllers;

use frontend\models\ResendVerificationEmailForm;
use frontend\models\VerifyEmailForm;
use Yii;
use yii\base\InvalidArgumentException;
use yii\web\BadRequestHttpException;
use yii\web\Controller;
use yii\filters\VerbFilter;
use yii\filters\AccessControl;
use common\models\LoginForm;
use frontend\models\PasswordResetRequestForm;
use frontend\models\ResetPasswordForm;
use frontend\models\SignupForm;
use frontend\models\ContactForm;

use frontend\models\Taskresponses;

use frontend\models\Transducers2;
use frontend\models\Transducers2Search;

use yii\web\Response;
use yii\data\ActiveDataProvider;
/**
 * Site controller
 */
class SiteController extends Controller
{
    public $layout='main';
    
    /**
     * {@inheritdoc}
     */
    public function behaviors()
    {
        return [
            'access' => [
                'class' => AccessControl::className(),
                'only' => ['logout', 'signup', 'index', 'calculate', 'support', 'api', 'showlisting'],
                'rules' => [
                    [
                        'actions' => ['signup'],
                        'allow' => true,
                        'roles' => ['?'],
                    ],
                    [
                        'actions' => ['logout', 'index', 'support', 'api', 'showlisting'],
                        'allow' => true,
                        'roles' => ['@'],
                    ],
                ],
            ],
            'verbs' => [
                'class' => VerbFilter::className(),
                'actions' => [
                   // 'logout' => ['post'],
                ],
            ],
			/*
			'contentNegotiator' => [
                'class' => 'yii\filters\ContentNegotiator',
                'formats' => [
                    'application/json' => \yii\web\Response::FORMAT_JSON,
                ]
            ]*/
        ];
    }
    
    public function beforeAction($action) {     
        $this->enableCsrfValidation = false;     
        return parent::beforeAction($action); 
        }

    /**
     * {@inheritdoc}
     */
    public function actions()
    {
        return [
            'error' => [
                'class' => 'yii\web\ErrorAction',
                'layout' => 'blank',
            ],
            'captcha' => [
                'class' => 'yii\captcha\CaptchaAction',
                'fixedVerifyCode' => YII_ENV_TEST ? 'testme' : null,
            ],
        ];
    }

    /**
     * Displays homepage.
     *
     * @return mixed
     */
    public function actionIndex11()
    {
        $tds=Yii::$app->request->post('Transducers2Search');
        var_dump($tds);
        $searchModel = new Transducers2Search();
        $dataProvider = $searchModel->search($this->request->queryParams);
        $dataProvider->pagination->pageSize=15;
        
        $sort_order = [];
        if(isset($tds['height_oa_sort']) && !($tds['height_oa_sort']=='')){$sort_order['HeightOA'] = $tds['height_oa_sort'];}
        if(isset($tds['cost_sort']) && !($tds['cost_sort']=='')){$sort_order['Cost'] = $tds['cost_sort'];}
        if(isset($tds['mass_oa_sort']) && !($tds['mass_oa_sort']=='')){$sort_order['MassOA'] = $tds['mass_oa_sort'];}
        if(isset($tds['diam_oa_sort']) && !($tds['diam_oa_sort']=='')){$sort_order['DiamOA'] = $tds['diam_oa_sort'];}
        if(isset($tds['pmax_rated_sort']) && !($tds['pmax_rated_sort']=='')){$sort_order['Pmax_Rated'] = $tds['pmax_rated_sort'];}

        if(count($sort_order)==0){$sort_order = ['id' =>SORT_ASC];}
        
        
        //var_dump($sort_order);
        $dataProvider->sort->defaultOrder = $sort_order; // ['id' =>SORT_ASC]; //SORT_DESC

        return $this->render('index', [
            'searchModel' => $searchModel,
            'dataProvider' => $dataProvider,
        ]);
        
        
        
        //return $this->render('index');
        //return $this->redirect(['links/index']);
        // $this->redirect(['results/calculate']);
    }

    public function actionIndex()
    {
        /*
        $tds=Yii::$app->request->get('Transducers2Search');
        var_dump($tds);
        $searchModel = new Transducers2Search();
        $dataProvider = $searchModel->search($this->request->queryParams);
        $dataProvider->pagination->pageSize=15;
        
        $sort_order = [];
        if(isset($tds['height_oa_sort']) && !($tds['height_oa_sort']=='')){$sort_order['HeightOA'] = $tds['height_oa_sort'];}
        if(isset($tds['cost_sort']) && !($tds['cost_sort']=='')){$sort_order['Cost'] = $tds['cost_sort'];}
        if(isset($tds['mass_oa_sort']) && !($tds['mass_oa_sort']=='')){$sort_order['MassOA'] = $tds['mass_oa_sort'];}
        if(isset($tds['diam_oa_sort']) && !($tds['diam_oa_sort']=='')){$sort_order['DiamOA'] = $tds['diam_oa_sort'];}
        if(isset($tds['pmax_rated_sort']) && !($tds['pmax_rated_sort']=='')){$sort_order['Pmax_Rated'] = $tds['pmax_rated_sort'];}

        if(count($sort_order)==0){$sort_order = ['id' =>SORT_ASC];}
        
        
        //var_dump($sort_order);
        $dataProvider->sort->defaultOrder = $sort_order; // ['id' =>SORT_ASC]; //SORT_DESC

        return $this->render('index', [
            'searchModel' => $searchModel,
            'dataProvider' => $dataProvider,
        ]);
        */
        
        $searchModel = new Transducers2Search();
        return $this->render('index', ['model' => $searchModel,]);
        //return $this->redirect(['links/index']);
        // $this->redirect(['results/calculate']);
    } 
    
public function actionShowlisting()
{
    $argPage = (int) Yii::$app->request->post('page', 0);
    

       
        $tds=Yii::$app->request->post('Transducers2Search');
        //$ths = $this->request->post('Transducers2Search');
       //var_dump($this);
       //exit; 
                      
    $sort_order = [];
    if(isset($tds['height_oa_sort']) && !($tds['height_oa_sort']=='')){
        if($tds['height_oa_sort']=='SORT_ASC'){$sort_order['HeightOA'] = SORT_ASC;}else{$sort_order['HeightOA'] = SORT_DESC;}
    }
    if(isset($tds['cost_sort']) && !($tds['cost_sort']=='')){
        if($tds['cost_sort']=='SORT_ASC'){$sort_order['Cost'] = SORT_ASC;}else{$sort_order['Cost'] = SORT_DESC;}
    }
    if(isset($tds['mass_oa_sort']) && !($tds['mass_oa_sort']=='')){
        if($tds['mass_oa_sort']=='SORT_ASC'){$sort_order['MassOA'] = SORT_ASC;}else{$sort_order['MassOA'] = SORT_DESC;}
    }
    if(isset($tds['diam_oa_sort']) && !($tds['diam_oa_sort']=='')){    
        if($tds['diam_oa_sort']=='SORT_ASC'){$sort_order['DiamOA'] = SORT_ASC;}else{$sort_order['DiamOA'] = SORT_DESC;}
    }
    if(isset($tds['pmax_rated_sort']) && !($tds['pmax_rated_sort']=='')){    
        if($tds['pmax_rated_sort']=='SORT_ASC'){$sort_order['Pmax_Rated'] = SORT_ASC;}else{$sort_order['Pmax_Rated'] = SORT_DESC;}
    }

    if(count($sort_order)==0){$sort_order = ['id' =>SORT_ASC];}    
       //var_dump($sort_order);
       //exit;
       
    $query = Transducers2::find(); //->where('1');
           
    $query->andFilterWhere(['in', 'Brand', $tds['Brand']])->andFilterWhere(['in', 'Type', $tds['Type']]);
                            
    $query->andFilterWhere(['>=', 'Cost', $tds['cost_min']])->andFilterWhere(['<=', 'Cost', $tds['cost_max']])
          ->andFilterWhere(['>=', 'DiamOA', $tds['diam_oa_min']])->andFilterWhere(['<=', 'DiamOA', $tds['diam_oa_max']])
          ->andFilterWhere(['>=', 'HeightOA', $tds['height_oa_min']])->andFilterWhere(['<=', 'HeightOA', $tds['height_oa_max']])
          ->andFilterWhere(['>=', 'MassOA', $tds['mass_oa_min']])->andFilterWhere(['<=', 'MassOA', $tds['mass_oa_max']])
          ->andFilterWhere(['>=', 'Pmax_Rated', $tds['pmax_rated_min']])->andFilterWhere(['<=', 'Pmax_Rated', $tds['pmax_rated_max']]);  
          
    $query->orderBy($sort_order);
               
//var_dump($query->prepare(Yii::$app->db->queryBuilder)->createCommand()->rawSql);
 //     exit;           
     $dataProvider =  new ActiveDataProvider([
            'query' => $query,
            'pagination' => ['pageSize' => 15, 'page' => $argPage],
            //'sort' => $sort_order,
            //'sort' => [
            //'defaultOrder' => $sort_order],
            ]);
            

        //$searchModel = new Transducers2Search();
        //$dataProvider = $searchModel->search($this->request->queryParams);
        //$dataProvider->pagination->pageSize=15;
        //$dataProvider->pagination->page = $argPage;
        
        

        

        //$dataProvider->sort->defaultOrder = $sort_order; // ['id' =>SORT_ASC]; //SORT_DESC
//$listResults = $dataProvider;
        //return $this->render('index', [
        //    'searchModel' => $searchModel,
        //    'dataProvider' => $dataProvider,
       // ]);

    // /////////////////////////////////////////////////////////////////////



   // $listResults   = Transducers2::model()->findAll($dbCriteria);
  // $listResults = (new \yii\db\Query())
  //  ->from('transducers2')
    //->leftJoin('my_joined_table', 'my_joined_table.my_id = my_table.id')
   // ->where('categoryMaster_id=:categoryMaster_id', ['categoryMaster_id' => $id])
  //  ->all(); 
    
//var_dump($listResults);
//exit;


    $this->renderPartial('result_list', ['dataProvider' => $dataProvider]);

} 

// Complex number helpers
public function cplx($re, $im=0.0) { return [$re, $im]; }
public function cadd($a,$b){ return [$a[0]+$b[0], $a[1]+$b[1]]; }
public function cmul($a,$b){ return [$a[0]*$b[0]-$a[1]*$b[1], $a[0]*$b[1]+$a[1]*$b[0]]; }
public function cdiv($a,$b){ $d=$b[0]*$b[0]+$b[1]*$b[1]; return [($a[0]*$b[0]+$a[1]*$b[1])/$d, ($a[1]*$b[0]-$a[0]*$b[1])/$d]; }
public function cabs($a){ return sqrt($a[0]*$a[0]+$a[1]*$a[1]); }
public function cinv($a){ $d=$a[0]*$a[0]+$a[1]*$a[1]; return [$a[0]/$d, -$a[1]/$d]; }
public function creal($a){ return $a[0]; }


 
    
    public function actionApi()
    {
		Yii::$app->response->format = Response::FORMAT_JSON;
		//$post = Yii::$app->request->post();
		$post = json_decode(\Yii::$app->getRequest()->getRawBody());
        
        $freqs = [10,10.3265085,10.663677,11.011854,11.371401,11.742686,12.126094,12.52202,12.930875,13.353078,13.789067,14.239291,14.704216,15.18432,15.6801,16.192068,16.720753,17.266699,17.83047,18.41265,19.013838,19.634655,20.275742,20.937761,21.621395,22.32735,23.056358,23.809166,24.586555,25.389326,26.218307,27.074356,27.958355,28.87122,29.813887,30.787334,31.792566,32.83062,33.902565,35.00951,36.1526,37.33301,38.551964,39.81072,41.11057,42.45286,43.83898,45.27036,46.748474,48.27485,49.851063,51.47874,53.15956,54.895264,56.68764,58.538536,60.449867,62.423603,64.461784,66.56651,68.73997,70.98438,73.30208,75.69545,78.16697,80.71918,83.35473,86.076324,88.88679,91.78901,94.785995,97.88084,101.07673,104.37696,107.78495,111.30422,114.93839,118.69122,122.56659,126.56848,130.70105,134.96854,139.37538,143.92609,148.6254,153.47813,158.48932,163.66412,169.00789,174.52614,180.22455,186.10902,192.18564,198.46065,204.94055,211.63203,218.54199,225.67755,233.04611,240.65526,248.51285,256.62698,265.00607,273.65872,282.5939,291.82083,301.349,311.1883,321.34885,331.84116,342.67603,353.8647,365.41864,377.34985,389.67062,402.39368,415.53217,429.09964,443.11008,457.57797,472.51828,487.94638,503.8782,520.33026,537.31946,554.86334,572.9801,591.68835,611.00745,630.95734,651.5586,672.8325,694.801,717.4869,740.9134,765.1048,790.0861,815.88306,842.5223,870.0313,898.43854,927.77325,958.0658,989.3475,1021.65045,1055.0082,1089.455,1125.0266,1161.7596,1199.692,1238.8629,1279.3127,1321.0834,1364.2178,1408.7606,1454.7578,1502.2568,1551.3068,1601.9581,1654.2633,1708.2764,1764.053,1821.6508,1881.1292,1942.5494,2005.9753,2071.472,2139.1072,2208.951,2281.075,2355.5537,2432.4646,2511.8865,2593.9016,2678.5945,2766.0527,2856.3667,2949.6294,3045.937,3145.3894,3248.0889,3354.1416,3463.657,3576.7483,3693.532,3814.1287,3938.663,4067.2637,4200.063,4337.1987,4478.8115,4625.0483,4776.06,4932.002,5093.036,5259.3276,5431.049,5608.377,5791.495,5980.5923,6175.8633,6377.5103,6585.741,6800.771,7022.8213,7252.122,7488.9097,7733.4287,7985.9316,8246.679,8515.939,8793.991,9081.122,9377.629,9683.815,10000]; 
        
        // Reference pressure for SPL
        $p_ref = 20e-6;
        $P_target = 1.0; // 1 Watt
        
        $baffles = [];
        $inf_baffles = [];
		if(count($post->inf_baffles)>0){
		  foreach($post->inf_baffles as $ib){
		      $woofer = $ib->woofer;
              
            // Example driver parameters (replace with your own values)
            $Re  = $woofer->re; // 6.0;      // Ohms
            $Le  = $woofer->le; // 0.0003;   // H
            $Bl  = $woofer->bl; // 8.0;      // N/A
            $Rms = $woofer->rms; // 1.2;      // N·s/m
            $Mms = $woofer->mms; // 0.020;    // kg
            $Cms = $woofer->cms; // 1.0e-3;   // m/N
            $Sd  = $woofer->sd; // 0.005;    // m^2
            $rho0 = 1.21;    // kg/m^3
            $c0   =  343.0;   // m/s
            $r    = 1.0;     // m
            //$V_rms $woofer->re; // = 2.0;    // Input RMS voltage (you can compute per frequency for 1W)
            
            $P_max =$woofer->pmax; // 100.0;    // thermal power rating (W)
            $Xmax  = $woofer->xmax; // 0.005;    // m (5 mm)
            
            
		      $spl = [];
              $spl_max = [];
            foreach($freqs as $f){
                
    $w = 2*pi()*$f;

    // Mechanical impedance
    $Zm = [$Rms, $w*$Mms - 1.0/($w*$Cms)];

    // Electrical reflected mech. impedance
    $Zem = Self::cdiv([$Bl*$Bl, 0], $Zm);

    // Total electrical impedance
    $Ztot = Self::cadd(Self::cadd([$Re, 0], [0, $w*$Le]), $Zem);

    // Calculate RMS input voltage that gives 1 W
    $Y = Self::cinv($Ztot); // admittance
    $ReY = Self::creal($Y);
    if ($ReY <= 0) { continue; } // skip invalid cases

    $V_rms = sqrt(2*$P_target / $ReY);

    // Cone velocity: v = (Bl*V) / (Ztot*Zm)
    $num = [$Bl*$V_rms, 0];
    $den = Self::cmul($Ztot, $Zm);
    $v = Self::cdiv($num, $den);

    // Excursion (m)
    $X = Self::cabs($v) / (2*pi()*$f);
    
    // Acoustic pressure: p = j??c * Sd/(4pr) * v
    $scale = $w*$rho0*$c0*$Sd/(4*pi()*$r);
    $j = [0,1];
    $p = Self::cmul(Self::cmul($j, [$scale,0]), $v);

    $p_mag = Self::cabs($p);  // Pa (RMS)
    $SPL = 20*log10($p_mag/$p_ref);
    
    
    $p1 = Self::cmul([0,1], [$scale*$v[0], $scale*$v[1]]);
    $p_mag1 = Self::cabs($p1);
    $SPL_1W = 20*log10($p_mag1/$p_ref);

    // Thermal limit
    $SPL_thermal = $SPL_1W + 10*log10($P_max);    
    
     // Mechanical limit: max power before X exceeds Xmax
    if ($X > 0) {
        $P_mech = $P_target * pow($Xmax/$X, 2);
        $SPL_mech = $SPL_1W + 10*log10($P_mech);
    } else {
        $SPL_mech = $SPL_thermal; // no motion
    }

    $SPL_max = min($SPL_thermal, $SPL_mech);   
    
    
    

                
  /*              
 "re"    =>$model->Re,   //6.0,
                            "bl"    =>$model->BL,  //13.5,
                            "mmd"   =>$model->Mm, //59.2,
                            "rms"   =>$model->Rm, //2.2,
                            "cms"   =>$model->Cm, //490.0,
                            "sd"    =>$model->Sd*10000, //340.0,
                            "le"    =>$model->Le, //1.38,
                            "fs"    =>$model->Fs, //28.5,
                            "qts"   =>$model->Qt, //0.35,
                            "xmax"  =>$model->Xmax*1000, //3.5,
                            "pmax"  =>$model->Pmax_Rated, //160,
                            "spl1w" =>$model->SPL1W, //88.5,
                            "z"     =>$model->Zres //8
                            
{
re:5.6,
bl:8.63,
mmd:6.3,
rms:3.63,
cms:340.0,
sd:65.0,
le:0.227,
fs:110.0,
qts:0.27,
xmax:5.6,
pmax:220,
frmin:100,
frmax:5000,
spl1w:90.1,
z:8}                            
                            
                            
                            
            */                               
               //$p = $woofer->sd*$woofer->xmax*pow($f,2)*3.14*1.2/sqrt(2)/1000000;
               //$p1 = 1.2*$woofer->bl*$woofer->sd/(6.28*$woofer->mmd*sqrt($woofer->re));
               $spl[] = [$f, $SPL/3];  //20 * log10($p1) + 20 * log10($f)
               $spl_max[] = [$f, $SPL_max/3];
            }
              
              
		      $baffles[]=[
                            'id' =>$ib->id,
                            'graphSize' => $ib->graphSize,
                            "spl" => $spl,
                            "spl_max" => $spl_max,
                            "spl_xmax" => [
                [10, 59.594475],
                [10.3265085, 60.152615],
                [10.663677, 60.710754],
                [11.011854, 61.268894],
                [11.371401, 61.827034],
                [11.742686, 62.385174],
                [12.126094, 62.943314],
                [12.52202, 63.501453],
                [12.930875, 64.05959],
                [13.353078, 64.61773],
                [13.789067, 65.17587],
                [14.239291, 65.73401],
                [14.704216, 66.29215],
                [15.18432, 66.85029],
                [15.6801, 67.40843],
                [16.192068, 67.96657],
                [16.720753, 68.52471],
                [17.266699, 69.08285],
                [17.83047, 69.64099],
                [18.41265, 70.19913],
                [19.013838, 70.75727],
                [19.634655, 71.31541],
                [20.275742, 71.87354],
                [20.937761, 72.43169],
                [21.621395, 72.98982],
                [22.32735, 73.547966],
                [23.056358, 74.1061],
                [23.809166, 74.664246],
                [24.586555, 75.22238],
                [25.389326, 75.780525],
                [26.218307, 76.33866],
                [27.074356, 76.896805],
                [27.958355, 77.45494],
                [28.87122, 78.013084],
                [29.813887, 78.57122],
                [30.787334, 79.12936],
                [31.792566, 79.6875],
                [32.83062, 80.245636],
                [33.902565, 80.80378],
                [35.00951, 81.361916],
                [36.1526, 81.92006],
                [37.33301, 82.478195],
                [38.551964, 83.03634],
                [39.81072, 83.594475],
                [41.11057, 84.15262],
                [42.45286, 84.710754],
                [43.83898, 85.2689],
                [45.27036, 85.827034],
                [46.748474, 86.38518],
                [48.27485, 86.94331],
                [49.851063, 87.50145],
                [51.47874, 88.05959],
                [53.15956, 88.61773],
                [54.895264, 89.17587],
                [56.68764, 89.73401],
                [58.538536, 90.29215],
                [60.449867, 90.85029],
                [62.423603, 91.40843],
                [64.461784, 91.96657],
                [66.56651, 92.52471],
                [68.73997, 93.08285],
                [70.98438, 93.64099],
                [73.30208, 94.19913],
                [75.69545, 94.75727],
                [78.16697, 95.31541],
                [80.71918, 95.87354],
                [83.35473, 96.43169],
                [86.076324, 96.98982],
                [88.88679, 97.547966],
                [91.78901, 98.1061],
                [94.785995, 98.664246],
                [97.88084, 99.22238],
                [101.07673, 99.780525],
                [104.37696, 100.33866],
                [107.78495, 100.896805],
                [111.30422, 101.45494],
                [114.93839, 102.013084],
                [118.69122, 102.57122],
                [122.56659, 103.12936],
                [126.56848, 103.6875],
            ],
            "spl_pmax" => [
                [130.70105, 104.03931],
                [134.96854, 104.302444],
                [139.37538, 104.563065],
                [143.92609, 104.82111],
                [148.6254, 105.07655],
                [153.47813, 105.32932],
                [158.48932, 105.57936],
                [163.66412, 105.82661],
                [169.00789, 106.071],
                [174.52614, 106.312454],
                [180.22455, 106.550896],
                [186.10902, 106.786255],
                [192.18564, 107.01844],
                [198.46065, 107.24736],
                [204.94055, 107.47294],
                [211.63203, 107.69508],
                [218.54199, 107.9137],
                [225.67755, 108.12869],
                [233.04611, 108.33997],
                [240.65526, 108.54746],
                [248.51285, 108.75105],
                [256.62698, 108.95067],
                [265.00607, 109.14622],
                [273.65872, 109.337616],
                [282.5939, 109.524796],
                [291.82083, 109.707664],
                [301.349, 109.88617],
                [311.1883, 110.06024],
                [321.34885, 110.22982],
                [331.84116, 110.39485],
                [342.67603, 110.55529],
                [353.8647, 110.71111],
                [365.41864, 110.86228],
                [377.34985, 111.008766],
                [389.67062, 111.15057],
                [402.39368, 111.28768],
                [415.53217, 111.420105],
                [429.09964, 111.54785],
                [443.11008, 111.670944],
                [457.57797, 111.78941],
                [472.51828, 111.90329],
                [487.94638, 112.01262],
                [503.8782, 112.11745],
                [520.33026, 112.21784],
                [537.31946, 112.313866],
                [554.86334, 112.40559],
                [572.9801, 112.493065],
                [591.68835, 112.5764],
                [611.00745, 112.655655],
                [630.95734, 112.73093],
                [651.5586, 112.8023],
                [672.8325, 112.869865],
                [694.801, 112.9337],
                [717.4869, 112.99391],
                [740.9134, 113.050575],
                [765.1048, 113.10379],
                [790.0861, 113.15364],
                [815.88306, 113.20022],
                [842.5223, 113.24359],
                [870.0313, 113.28385],
                [898.43854, 113.321075],
                [927.77325, 113.35533],
                [958.0658, 113.386696],
                [989.3475, 113.41522],
                [1021.65045, 113.44097],
                [1055.0082, 113.46401],
                [1089.455, 113.48437],
                [1125.0266, 113.502106],
                [1161.7596, 113.51724],
                [1199.692, 113.529816],
                [1238.8629, 113.53984],
                [1279.3127, 113.54734],
                [1321.0834, 113.55232],
                [1364.2178, 113.55479],
                [1408.7606, 113.55472],
                [1454.7578, 113.5521],
                [1502.2568, 113.54692],
                [1551.3068, 113.53914],
                [1601.9581, 113.5287],
                [1654.2633, 113.51557],
                [1708.2764, 113.49968],
                [1764.053, 113.48096],
                [1821.6508, 113.45931],
                [1881.1292, 113.434654],
                [1942.5494, 113.406876],
                [2005.9753, 113.37587],
                [2071.472, 113.34149],
                [2139.1072, 113.303604],
                [2208.951, 113.26206],
                [2281.075, 113.21668],
                [2355.5537, 113.16731],
                [2432.4646, 113.11374],
                [2511.8865, 113.05578],
                [2593.9016, 112.99322],
                [2678.5945, 112.92585],
                [2766.0527, 112.85344],
                [2856.3667, 112.77577],
                [2949.6294, 112.692635],
                [3045.937, 112.6038],
                [3145.3894, 112.50906],
                [3248.0889, 112.40823],
                [3354.1416, 112.30114],
                [3463.657, 112.187645],
                [3576.7483, 112.067635],
                [3693.532, 111.94104],
                [3814.1287, 111.807846],
                [3938.663, 111.66807],
                [4067.2637, 111.521805],
                [4200.063, 111.3692],
                [4337.1987, 111.21045],
                [4478.8115, 111.04582],
                [4625.0483, 110.87562],
                [4776.06, 110.7002],
                [4932.002, 110.519966],
                [5093.036, 110.335304],
                [5259.3276, 110.14662],
                [5431.049, 109.95431],
                [5608.377, 109.758705],
                [5791.495, 109.5601],
                [5980.5923, 109.35869],
                [6175.8633, 109.15461],
                [6377.5103, 108.94787],
                [6585.741, 108.7384],
                [6800.771, 108.52608],
                [7022.8213, 108.31067],
                [7252.122, 108.09198],
                [7488.9097, 107.86981],
                [7733.4287, 107.64404],
                [7985.9316, 107.414665],
                [8246.679, 107.1818],
                [8515.939, 106.94573],
                [8793.991, 106.706856],
                [9081.122, 106.465645],
                [9377.629, 106.222595],
                [9683.815, 105.9781],
                [10000, 105.732414],
            ],
            "spl1w" => [[10, 90.1], [10000, 90.1]],
            "fs" => [[104.37696, -180], [104.37696, 1000]],
            "spl_qts" => [
                [30.787334, 65.85292],
                [31.792566, 66.26265],
                [32.83062, 66.66779],
                [33.902565, 67.068375],
                [35.00951, 67.46441],
                [36.1526, 67.85594],
                [37.33301, 68.243004],
                [38.551964, 68.62565],
                [39.81072, 69.00392],
                [41.11057, 69.37789],
                [42.45286, 69.74762],
                [43.83898, 70.113174],
                [45.27036, 70.47464],
                [46.748474, 70.8321],
                [48.27485, 71.18562],
                [49.851063, 71.5353],
                [51.47874, 71.881226],
                [53.15956, 72.22348],
                [54.895264, 72.56216],
                [56.68764, 72.89734],
                [58.538536, 73.229126],
                [60.449867, 73.557594],
                [62.423603, 73.882835],
                [64.461784, 74.20493],
                [66.56651, 74.52397],
                [68.73997, 74.84003],
                [70.98438, 75.15317],
                [73.30208, 75.46347],
                [75.69545, 75.770996],
                [78.16697, 76.07582],
                [80.71918, 76.37798],
                [83.35473, 76.67755],
                [86.076324, 76.97457],
                [88.88679, 77.26907],
                [91.78901, 77.56111],
                [94.785995, 77.8507],
                [97.88084, 78.13788],
                [101.07673, 78.42266],
                [104.37696, 78.705055],
                [107.78495, 78.985085],
                [111.30422, 79.26273],
                [114.93839, 79.53801],
                [118.69122, 79.810905],
                [122.56659, 80.08139],
                [126.56848, 80.349464],
                [130.70105, 80.61508],
                [134.96854, 80.87822],
                [139.37538, 81.13883],
                [143.92609, 81.39689],
                [148.6254, 81.65232],
                [153.47813, 81.90509],
                [158.48932, 82.155136],
                [163.66412, 82.40238],
                [169.00789, 82.646774],
                [174.52614, 82.88823],
                [180.22455, 83.12667],
                [186.10902, 83.36203],
                [192.18564, 83.59421],
                [198.46065, 83.823135],
                [204.94055, 84.04871],
                [211.63203, 84.27085],
                [218.54199, 84.48947],
                [225.67755, 84.70447],
                [233.04611, 84.91575],
                [240.65526, 85.12324],
                [248.51285, 85.32683],
                [256.62698, 85.52644],
                [265.00607, 85.72199],
                [273.65872, 85.91339],
                [282.5939, 86.10056],
                [291.82083, 86.28344],
                [301.349, 86.461945],
                [311.1883, 86.63602],
                [321.34885, 86.80559],
                [331.84116, 86.97062],
                [342.67603, 87.131065],
            ],
            "spl_le" => [
                [3938.663, 88.24384],
                [4067.2637, 88.09758],
                [4200.063, 87.94498],
                [4337.1987, 87.786224],
                [4478.8115, 87.62159],
                [4625.0483, 87.45139],
                [4776.06, 87.27598],
                [4932.002, 87.09574],
                [5093.036, 86.91108],
                [5259.3276, 86.7224],
                [5431.049, 86.53008],
                [5608.377, 86.33448],
                [5791.495, 86.13587],
                [5980.5923, 85.93446],
                [6175.8633, 85.73038],
                [6377.5103, 85.52364],
                [6585.741, 85.31418],
                [6800.771, 85.101845],
                [7022.8213, 84.886444],
                [7252.122, 84.667755],
                [7488.9097, 84.44559],
                [7733.4287, 84.21982],
                [7985.9316, 83.99043],
                [8246.679, 83.757576],
                [8515.939, 83.52151],
                [8793.991, 83.28263],
                [9081.122, 83.04142],
                [9377.629, 82.79837],
                [9683.815, 82.55387],
                [10000, 82.30819],
            ],
            "fr" => [
                [101.07673, 0],
                [101.07673, 200],
                [4932.002, 200],
                [4932.002, 0],
            ],
                            
                            
                            
                            //'woofer' => json_encode($ib->woofer),
                            //'amplifier' => json_encode
              ];
		      //var_dump($ib);
              //exit;
              
              
    /*          
  object(stdClass)[119]
  public 'id' => int 406
  public 'graphSize' => string 'mini' (length=4)
  public 'woofer' => 
    object(stdClass)[126]
      public 're' => float 2.7
      public 'bl' => float 9.6
      public 'mmd' => float 0.041020833
      public 'rms' => float 1.84
      public 'cms' => float 0.000289
      public 'sd' => int 531
      public 'le' => float 0.00067
      public 'fs' => int 49
      public 'qts' => float 0.35
      public 'xmax' => int 4
      public 'pmax' => null
      public 'spl1w' => float 96.8
      public 'z' => float 52.72027698
  public 'amplifier' => 
    object(stdClass)[131]
      public 'pw' => int 1
  public 'scale' => 
    object(stdClass)[133]
      public 'type' => string 'log' (length=3)
      public 'steps_nb' => int 216
      public 'min' => int 10
      public 'max' => int 10000
  public 'time_response' => 
    object(stdClass)[134]
      public 'min' => int -2
      public 'max' => int 20
      public 'f' => int 150
      public 'cycles' => int 3
              
     */         
              
              
              
              
              
              
              
              
              
              
              
              
              

		  }
		}

		//return json_encode($post, true);
		//var_dump($post);  
        
        
  $arrayVar["inf_baffles"] = $baffles;
 return $arrayVar; 
 /*         
exit;
$arrayVar = [
    "inf_baffles" => [
        [
            "id" => 305,
            "graphSize" => "mini",
            "spl" => [
                [10, 49.040764],
                [10.3265085, 49.569527],
                [10.663677, 50.096554],
                [11.011854, 50.621758],
                [11.371401, 51.145046],
                [11.742686, 51.66632],
                [12.126094, 52.18549],
                [12.52202, 52.702446],
                [12.930875, 53.21709],
                [13.353078, 53.729317],
                [13.789067, 54.239017],
                [14.239291, 54.746082],
                [14.704216, 55.250404],
                [15.18432, 55.75187],
                [15.6801, 56.250362],
                [16.192068, 56.745777],
                [16.720753, 57.237995],
                [17.266699, 57.72691],
                [17.83047, 58.212406],
                [18.41265, 58.694378],
                [19.013838, 59.172718],
                [19.634655, 59.64732],
                [20.275742, 60.118084],
                [20.937761, 60.58492],
                [21.621395, 61.047726],
                [22.32735, 61.506424],
                [23.056358, 61.960926],
                [23.809166, 62.411163],
                [24.586555, 62.857063],
                [25.389326, 63.29857],
                [26.218307, 63.735626],
                [27.074356, 64.16819],
                [27.958355, 64.59623],
                [28.87122, 65.01971],
                [29.813887, 65.43861],
                [30.787334, 65.85292],
                [31.792566, 66.26265],
                [32.83062, 66.66779],
                [33.902565, 67.068375],
                [35.00951, 67.46441],
                [36.1526, 67.85594],
                [37.33301, 68.243004],
                [38.551964, 68.62565],
                [39.81072, 69.00392],
                [41.11057, 69.37789],
                [42.45286, 69.74762],
                [43.83898, 70.113174],
                [45.27036, 70.47464],
                [46.748474, 70.8321],
                [48.27485, 71.18562],
                [49.851063, 71.5353],
                [51.47874, 71.881226],
                [53.15956, 72.22348],
                [54.895264, 72.56216],
                [56.68764, 72.89734],
                [58.538536, 73.229126],
                [60.449867, 73.557594],
                [62.423603, 73.882835],
                [64.461784, 74.20493],
                [66.56651, 74.52397],
                [68.73997, 74.84003],
                [70.98438, 75.15317],
                [73.30208, 75.46347],
                [75.69545, 75.770996],
                [78.16697, 76.07582],
                [80.71918, 76.37798],
                [83.35473, 76.67755],
                [86.076324, 76.97457],
                [88.88679, 77.26907],
                [91.78901, 77.56111],
                [94.785995, 77.8507],
                [97.88084, 78.13788],
                [101.07673, 78.42266],
                [104.37696, 78.705055],
                [107.78495, 78.985085],
                [111.30422, 79.26273],
                [114.93839, 79.53801],
                [118.69122, 79.810905],
                [122.56659, 80.08139],
                [126.56848, 80.349464],
                [130.70105, 80.61508],
                [134.96854, 80.87822],
                [139.37538, 81.13883],
                [143.92609, 81.39689],
                [148.6254, 81.65232],
                [153.47813, 81.90509],
                [158.48932, 82.155136],
                [163.66412, 82.40238],
                [169.00789, 82.646774],
                [174.52614, 82.88823],
                [180.22455, 83.12667],
                [186.10902, 83.36203],
                [192.18564, 83.59421],
                [198.46065, 83.823135],
                [204.94055, 84.04871],
                [211.63203, 84.27085],
                [218.54199, 84.48947],
                [225.67755, 84.70447],
                [233.04611, 84.91575],
                [240.65526, 85.12324],
                [248.51285, 85.32683],
                [256.62698, 85.52644],
                [265.00607, 85.72199],
                [273.65872, 85.91339],
                [282.5939, 86.10056],
                [291.82083, 86.28344],
                [301.349, 86.461945],
                [311.1883, 86.63602],
                [321.34885, 86.80559],
                [331.84116, 86.97062],
                [342.67603, 87.131065],
                [353.8647, 87.28689],
                [365.41864, 87.43805],
                [377.34985, 87.58454],
                [389.67062, 87.72635],
                [402.39368, 87.86346],
                [415.53217, 87.99588],
                [429.09964, 88.12363],
                [443.11008, 88.24672],
                [457.57797, 88.36518],
                [472.51828, 88.47906],
                [487.94638, 88.58839],
                [503.8782, 88.69322],
                [520.33026, 88.79362],
                [537.31946, 88.88964],
                [554.86334, 88.98135],
                [572.9801, 89.06884],
                [591.68835, 89.15217],
                [611.00745, 89.23143],
                [630.95734, 89.3067],
                [651.5586, 89.378075],
                [672.8325, 89.44563],
                [694.801, 89.509476],
                [717.4869, 89.56969],
                [740.9134, 89.62635],
                [765.1048, 89.679565],
                [790.0861, 89.729416],
                [815.88306, 89.775986],
                [842.5223, 89.81937],
                [870.0313, 89.85963],
                [898.43854, 89.89685],
                [927.77325, 89.93111],
                [958.0658, 89.96246],
                [989.3475, 89.99099],
                [1021.65045, 90.01675],
                [1055.0082, 90.03978],
                [1089.455, 90.06014],
                [1125.0266, 90.07787],
                [1161.7596, 90.09301],
                [1199.692, 90.10558],
                [1238.8629, 90.115616],
                [1279.3127, 90.123116],
                [1321.0834, 90.1281],
                [1364.2178, 90.130554],
                [1408.7606, 90.13049],
                [1454.7578, 90.12788],
                [1502.2568, 90.122696],
                [1551.3068, 90.11491],
                [1601.9581, 90.10448],
                [1654.2633, 90.09135],
                [1708.2764, 90.075455],
                [1764.053, 90.05673],
                [1821.6508, 90.03509],
                [1881.1292, 90.01043],
                [1942.5494, 89.98265],
                [2005.9753, 89.95164],
                [2071.472, 89.91726],
                [2139.1072, 89.87938],
                [2208.951, 89.83783],
                [2281.075, 89.79246],
                [2355.5537, 89.74308],
                [2432.4646, 89.689514],
                [2511.8865, 89.63155],
                [2593.9016, 89.56899],
                [2678.5945, 89.50162],
                [2766.0527, 89.429214],
                [2856.3667, 89.35155],
                [2949.6294, 89.26841],
                [3045.937, 89.17957],
                [3145.3894, 89.08483],
                [3248.0889, 88.984],
                [3354.1416, 88.876915],
                [3463.657, 88.76342],
                [3576.7483, 88.64341],
                [3693.532, 88.516815],
                [3814.1287, 88.38362],
                [3938.663, 88.24384],
                [4067.2637, 88.09758],
                [4200.063, 87.94498],
                [4337.1987, 87.786224],
                [4478.8115, 87.62159],
                [4625.0483, 87.45139],
                [4776.06, 87.27598],
                [4932.002, 87.09574],
                [5093.036, 86.91108],
                [5259.3276, 86.7224],
                [5431.049, 86.53008],
                [5608.377, 86.33448],
                [5791.495, 86.13587],
                [5980.5923, 85.93446],
                [6175.8633, 85.73038],
                [6377.5103, 85.52364],
                [6585.741, 85.31418],
                [6800.771, 85.101845],
                [7022.8213, 84.886444],
                [7252.122, 84.667755],
                [7488.9097, 84.44559],
                [7733.4287, 84.21982],
                [7985.9316, 83.99043],
                [8246.679, 83.757576],
                [8515.939, 83.52151],
                [8793.991, 83.28263],
                [9081.122, 83.04142],
                [9377.629, 82.79837],
                [9683.815, 82.55387],
                [10000, 82.30819],
            ],
            "spl_max" => [
                [10, 59.594475],
                [10.3265085, 60.152615],
                [10.663677, 60.710754],
                [11.011854, 61.268894],
                [11.371401, 61.827034],
                [11.742686, 62.385174],
                [12.126094, 62.943314],
                [12.52202, 63.501453],
                [12.930875, 64.05959],
                [13.353078, 64.61773],
                [13.789067, 65.17587],
                [14.239291, 65.73401],
                [14.704216, 66.29215],
                [15.18432, 66.85029],
                [15.6801, 67.40843],
                [16.192068, 67.96657],
                [16.720753, 68.52471],
                [17.266699, 69.08285],
                [17.83047, 69.64099],
                [18.41265, 70.19913],
                [19.013838, 70.75727],
                [19.634655, 71.31541],
                [20.275742, 71.87354],
                [20.937761, 72.43169],
                [21.621395, 72.98982],
                [22.32735, 73.547966],
                [23.056358, 74.1061],
                [23.809166, 74.664246],
                [24.586555, 75.22238],
                [25.389326, 75.780525],
                [26.218307, 76.33866],
                [27.074356, 76.896805],
                [27.958355, 77.45494],
                [28.87122, 78.013084],
                [29.813887, 78.57122],
                [30.787334, 79.12936],
                [31.792566, 79.6875],
                [32.83062, 80.245636],
                [33.902565, 80.80378],
                [35.00951, 81.361916],
                [36.1526, 81.92006],
                [37.33301, 82.478195],
                [38.551964, 83.03634],
                [39.81072, 83.594475],
                [41.11057, 84.15262],
                [42.45286, 84.710754],
                [43.83898, 85.2689],
                [45.27036, 85.827034],
                [46.748474, 86.38518],
                [48.27485, 86.94331],
                [49.851063, 87.50145],
                [51.47874, 88.05959],
                [53.15956, 88.61773],
                [54.895264, 89.17587],
                [56.68764, 89.73401],
                [58.538536, 90.29215],
                [60.449867, 90.85029],
                [62.423603, 91.40843],
                [64.461784, 91.96657],
                [66.56651, 92.52471],
                [68.73997, 93.08285],
                [70.98438, 93.64099],
                [73.30208, 94.19913],
                [75.69545, 94.75727],
                [78.16697, 95.31541],
                [80.71918, 95.87354],
                [83.35473, 96.43169],
                [86.076324, 96.98982],
                [88.88679, 97.547966],
                [91.78901, 98.1061],
                [94.785995, 98.664246],
                [97.88084, 99.22238],
                [101.07673, 99.780525],
                [104.37696, 100.33866],
                [107.78495, 100.896805],
                [111.30422, 101.45494],
                [114.93839, 102.013084],
                [118.69122, 102.57122],
                [122.56659, 103.12936],
                [126.56848, 103.6875],
                [130.70105, 104.03931],
                [134.96854, 104.302444],
                [139.37538, 104.563065],
                [143.92609, 104.82111],
                [148.6254, 105.07655],
                [153.47813, 105.32932],
                [158.48932, 105.57936],
                [163.66412, 105.82661],
                [169.00789, 106.071],
                [174.52614, 106.312454],
                [180.22455, 106.550896],
                [186.10902, 106.786255],
                [192.18564, 107.01844],
                [198.46065, 107.24736],
                [204.94055, 107.47294],
                [211.63203, 107.69508],
                [218.54199, 107.9137],
                [225.67755, 108.12869],
                [233.04611, 108.33997],
                [240.65526, 108.54746],
                [248.51285, 108.75105],
                [256.62698, 108.95067],
                [265.00607, 109.14622],
                [273.65872, 109.337616],
                [282.5939, 109.524796],
                [291.82083, 109.707664],
                [301.349, 109.88617],
                [311.1883, 110.06024],
                [321.34885, 110.22982],
                [331.84116, 110.39485],
                [342.67603, 110.55529],
                [353.8647, 110.71111],
                [365.41864, 110.86228],
                [377.34985, 111.008766],
                [389.67062, 111.15057],
                [402.39368, 111.28768],
                [415.53217, 111.420105],
                [429.09964, 111.54785],
                [443.11008, 111.670944],
                [457.57797, 111.78941],
                [472.51828, 111.90329],
                [487.94638, 112.01262],
                [503.8782, 112.11745],
                [520.33026, 112.21784],
                [537.31946, 112.313866],
                [554.86334, 112.40559],
                [572.9801, 112.493065],
                [591.68835, 112.5764],
                [611.00745, 112.655655],
                [630.95734, 112.73093],
                [651.5586, 112.8023],
                [672.8325, 112.869865],
                [694.801, 112.9337],
                [717.4869, 112.99391],
                [740.9134, 113.050575],
                [765.1048, 113.10379],
                [790.0861, 113.15364],
                [815.88306, 113.20022],
                [842.5223, 113.24359],
                [870.0313, 113.28385],
                [898.43854, 113.321075],
                [927.77325, 113.35533],
                [958.0658, 113.386696],
                [989.3475, 113.41522],
                [1021.65045, 113.44097],
                [1055.0082, 113.46401],
                [1089.455, 113.48437],
                [1125.0266, 113.502106],
                [1161.7596, 113.51724],
                [1199.692, 113.529816],
                [1238.8629, 113.53984],
                [1279.3127, 113.54734],
                [1321.0834, 113.55232],
                [1364.2178, 113.55479],
                [1408.7606, 113.55472],
                [1454.7578, 113.5521],
                [1502.2568, 113.54692],
                [1551.3068, 113.53914],
                [1601.9581, 113.5287],
                [1654.2633, 113.51557],
                [1708.2764, 113.49968],
                [1764.053, 113.48096],
                [1821.6508, 113.45931],
                [1881.1292, 113.434654],
                [1942.5494, 113.406876],
                [2005.9753, 113.37587],
                [2071.472, 113.34149],
                [2139.1072, 113.303604],
                [2208.951, 113.26206],
                [2281.075, 113.21668],
                [2355.5537, 113.16731],
                [2432.4646, 113.11374],
                [2511.8865, 113.05578],
                [2593.9016, 112.99322],
                [2678.5945, 112.92585],
                [2766.0527, 112.85344],
                [2856.3667, 112.77577],
                [2949.6294, 112.692635],
                [3045.937, 112.6038],
                [3145.3894, 112.50906],
                [3248.0889, 112.40823],
                [3354.1416, 112.30114],
                [3463.657, 112.187645],
                [3576.7483, 112.067635],
                [3693.532, 111.94104],
                [3814.1287, 111.807846],
                [3938.663, 111.66807],
                [4067.2637, 111.521805],
                [4200.063, 111.3692],
                [4337.1987, 111.21045],
                [4478.8115, 111.04582],
                [4625.0483, 110.87562],
                [4776.06, 110.7002],
                [4932.002, 110.519966],
                [5093.036, 110.335304],
                [5259.3276, 110.14662],
                [5431.049, 109.95431],
                [5608.377, 109.758705],
                [5791.495, 109.5601],
                [5980.5923, 109.35869],
                [6175.8633, 109.15461],
                [6377.5103, 108.94787],
                [6585.741, 108.7384],
                [6800.771, 108.52608],
                [7022.8213, 108.31067],
                [7252.122, 108.09198],
                [7488.9097, 107.86981],
                [7733.4287, 107.64404],
                [7985.9316, 107.414665],
                [8246.679, 107.1818],
                [8515.939, 106.94573],
                [8793.991, 106.706856],
                [9081.122, 106.465645],
                [9377.629, 106.222595],
                [9683.815, 105.9781],
                [10000, 105.732414],
            ],
            "spl_xmax" => [
                [10, 59.594475],
                [10.3265085, 60.152615],
                [10.663677, 60.710754],
                [11.011854, 61.268894],
                [11.371401, 61.827034],
                [11.742686, 62.385174],
                [12.126094, 62.943314],
                [12.52202, 63.501453],
                [12.930875, 64.05959],
                [13.353078, 64.61773],
                [13.789067, 65.17587],
                [14.239291, 65.73401],
                [14.704216, 66.29215],
                [15.18432, 66.85029],
                [15.6801, 67.40843],
                [16.192068, 67.96657],
                [16.720753, 68.52471],
                [17.266699, 69.08285],
                [17.83047, 69.64099],
                [18.41265, 70.19913],
                [19.013838, 70.75727],
                [19.634655, 71.31541],
                [20.275742, 71.87354],
                [20.937761, 72.43169],
                [21.621395, 72.98982],
                [22.32735, 73.547966],
                [23.056358, 74.1061],
                [23.809166, 74.664246],
                [24.586555, 75.22238],
                [25.389326, 75.780525],
                [26.218307, 76.33866],
                [27.074356, 76.896805],
                [27.958355, 77.45494],
                [28.87122, 78.013084],
                [29.813887, 78.57122],
                [30.787334, 79.12936],
                [31.792566, 79.6875],
                [32.83062, 80.245636],
                [33.902565, 80.80378],
                [35.00951, 81.361916],
                [36.1526, 81.92006],
                [37.33301, 82.478195],
                [38.551964, 83.03634],
                [39.81072, 83.594475],
                [41.11057, 84.15262],
                [42.45286, 84.710754],
                [43.83898, 85.2689],
                [45.27036, 85.827034],
                [46.748474, 86.38518],
                [48.27485, 86.94331],
                [49.851063, 87.50145],
                [51.47874, 88.05959],
                [53.15956, 88.61773],
                [54.895264, 89.17587],
                [56.68764, 89.73401],
                [58.538536, 90.29215],
                [60.449867, 90.85029],
                [62.423603, 91.40843],
                [64.461784, 91.96657],
                [66.56651, 92.52471],
                [68.73997, 93.08285],
                [70.98438, 93.64099],
                [73.30208, 94.19913],
                [75.69545, 94.75727],
                [78.16697, 95.31541],
                [80.71918, 95.87354],
                [83.35473, 96.43169],
                [86.076324, 96.98982],
                [88.88679, 97.547966],
                [91.78901, 98.1061],
                [94.785995, 98.664246],
                [97.88084, 99.22238],
                [101.07673, 99.780525],
                [104.37696, 100.33866],
                [107.78495, 100.896805],
                [111.30422, 101.45494],
                [114.93839, 102.013084],
                [118.69122, 102.57122],
                [122.56659, 103.12936],
                [126.56848, 103.6875],
            ],
            "spl_pmax" => [
                [130.70105, 104.03931],
                [134.96854, 104.302444],
                [139.37538, 104.563065],
                [143.92609, 104.82111],
                [148.6254, 105.07655],
                [153.47813, 105.32932],
                [158.48932, 105.57936],
                [163.66412, 105.82661],
                [169.00789, 106.071],
                [174.52614, 106.312454],
                [180.22455, 106.550896],
                [186.10902, 106.786255],
                [192.18564, 107.01844],
                [198.46065, 107.24736],
                [204.94055, 107.47294],
                [211.63203, 107.69508],
                [218.54199, 107.9137],
                [225.67755, 108.12869],
                [233.04611, 108.33997],
                [240.65526, 108.54746],
                [248.51285, 108.75105],
                [256.62698, 108.95067],
                [265.00607, 109.14622],
                [273.65872, 109.337616],
                [282.5939, 109.524796],
                [291.82083, 109.707664],
                [301.349, 109.88617],
                [311.1883, 110.06024],
                [321.34885, 110.22982],
                [331.84116, 110.39485],
                [342.67603, 110.55529],
                [353.8647, 110.71111],
                [365.41864, 110.86228],
                [377.34985, 111.008766],
                [389.67062, 111.15057],
                [402.39368, 111.28768],
                [415.53217, 111.420105],
                [429.09964, 111.54785],
                [443.11008, 111.670944],
                [457.57797, 111.78941],
                [472.51828, 111.90329],
                [487.94638, 112.01262],
                [503.8782, 112.11745],
                [520.33026, 112.21784],
                [537.31946, 112.313866],
                [554.86334, 112.40559],
                [572.9801, 112.493065],
                [591.68835, 112.5764],
                [611.00745, 112.655655],
                [630.95734, 112.73093],
                [651.5586, 112.8023],
                [672.8325, 112.869865],
                [694.801, 112.9337],
                [717.4869, 112.99391],
                [740.9134, 113.050575],
                [765.1048, 113.10379],
                [790.0861, 113.15364],
                [815.88306, 113.20022],
                [842.5223, 113.24359],
                [870.0313, 113.28385],
                [898.43854, 113.321075],
                [927.77325, 113.35533],
                [958.0658, 113.386696],
                [989.3475, 113.41522],
                [1021.65045, 113.44097],
                [1055.0082, 113.46401],
                [1089.455, 113.48437],
                [1125.0266, 113.502106],
                [1161.7596, 113.51724],
                [1199.692, 113.529816],
                [1238.8629, 113.53984],
                [1279.3127, 113.54734],
                [1321.0834, 113.55232],
                [1364.2178, 113.55479],
                [1408.7606, 113.55472],
                [1454.7578, 113.5521],
                [1502.2568, 113.54692],
                [1551.3068, 113.53914],
                [1601.9581, 113.5287],
                [1654.2633, 113.51557],
                [1708.2764, 113.49968],
                [1764.053, 113.48096],
                [1821.6508, 113.45931],
                [1881.1292, 113.434654],
                [1942.5494, 113.406876],
                [2005.9753, 113.37587],
                [2071.472, 113.34149],
                [2139.1072, 113.303604],
                [2208.951, 113.26206],
                [2281.075, 113.21668],
                [2355.5537, 113.16731],
                [2432.4646, 113.11374],
                [2511.8865, 113.05578],
                [2593.9016, 112.99322],
                [2678.5945, 112.92585],
                [2766.0527, 112.85344],
                [2856.3667, 112.77577],
                [2949.6294, 112.692635],
                [3045.937, 112.6038],
                [3145.3894, 112.50906],
                [3248.0889, 112.40823],
                [3354.1416, 112.30114],
                [3463.657, 112.187645],
                [3576.7483, 112.067635],
                [3693.532, 111.94104],
                [3814.1287, 111.807846],
                [3938.663, 111.66807],
                [4067.2637, 111.521805],
                [4200.063, 111.3692],
                [4337.1987, 111.21045],
                [4478.8115, 111.04582],
                [4625.0483, 110.87562],
                [4776.06, 110.7002],
                [4932.002, 110.519966],
                [5093.036, 110.335304],
                [5259.3276, 110.14662],
                [5431.049, 109.95431],
                [5608.377, 109.758705],
                [5791.495, 109.5601],
                [5980.5923, 109.35869],
                [6175.8633, 109.15461],
                [6377.5103, 108.94787],
                [6585.741, 108.7384],
                [6800.771, 108.52608],
                [7022.8213, 108.31067],
                [7252.122, 108.09198],
                [7488.9097, 107.86981],
                [7733.4287, 107.64404],
                [7985.9316, 107.414665],
                [8246.679, 107.1818],
                [8515.939, 106.94573],
                [8793.991, 106.706856],
                [9081.122, 106.465645],
                [9377.629, 106.222595],
                [9683.815, 105.9781],
                [10000, 105.732414],
            ],
            "spl1w" => [[10, 90.1], [10000, 90.1]],
            "fs" => [[104.37696, -180], [104.37696, 1000]],
            "spl_qts" => [
                [30.787334, 65.85292],
                [31.792566, 66.26265],
                [32.83062, 66.66779],
                [33.902565, 67.068375],
                [35.00951, 67.46441],
                [36.1526, 67.85594],
                [37.33301, 68.243004],
                [38.551964, 68.62565],
                [39.81072, 69.00392],
                [41.11057, 69.37789],
                [42.45286, 69.74762],
                [43.83898, 70.113174],
                [45.27036, 70.47464],
                [46.748474, 70.8321],
                [48.27485, 71.18562],
                [49.851063, 71.5353],
                [51.47874, 71.881226],
                [53.15956, 72.22348],
                [54.895264, 72.56216],
                [56.68764, 72.89734],
                [58.538536, 73.229126],
                [60.449867, 73.557594],
                [62.423603, 73.882835],
                [64.461784, 74.20493],
                [66.56651, 74.52397],
                [68.73997, 74.84003],
                [70.98438, 75.15317],
                [73.30208, 75.46347],
                [75.69545, 75.770996],
                [78.16697, 76.07582],
                [80.71918, 76.37798],
                [83.35473, 76.67755],
                [86.076324, 76.97457],
                [88.88679, 77.26907],
                [91.78901, 77.56111],
                [94.785995, 77.8507],
                [97.88084, 78.13788],
                [101.07673, 78.42266],
                [104.37696, 78.705055],
                [107.78495, 78.985085],
                [111.30422, 79.26273],
                [114.93839, 79.53801],
                [118.69122, 79.810905],
                [122.56659, 80.08139],
                [126.56848, 80.349464],
                [130.70105, 80.61508],
                [134.96854, 80.87822],
                [139.37538, 81.13883],
                [143.92609, 81.39689],
                [148.6254, 81.65232],
                [153.47813, 81.90509],
                [158.48932, 82.155136],
                [163.66412, 82.40238],
                [169.00789, 82.646774],
                [174.52614, 82.88823],
                [180.22455, 83.12667],
                [186.10902, 83.36203],
                [192.18564, 83.59421],
                [198.46065, 83.823135],
                [204.94055, 84.04871],
                [211.63203, 84.27085],
                [218.54199, 84.48947],
                [225.67755, 84.70447],
                [233.04611, 84.91575],
                [240.65526, 85.12324],
                [248.51285, 85.32683],
                [256.62698, 85.52644],
                [265.00607, 85.72199],
                [273.65872, 85.91339],
                [282.5939, 86.10056],
                [291.82083, 86.28344],
                [301.349, 86.461945],
                [311.1883, 86.63602],
                [321.34885, 86.80559],
                [331.84116, 86.97062],
                [342.67603, 87.131065],
            ],
            "spl_le" => [
                [3938.663, 88.24384],
                [4067.2637, 88.09758],
                [4200.063, 87.94498],
                [4337.1987, 87.786224],
                [4478.8115, 87.62159],
                [4625.0483, 87.45139],
                [4776.06, 87.27598],
                [4932.002, 87.09574],
                [5093.036, 86.91108],
                [5259.3276, 86.7224],
                [5431.049, 86.53008],
                [5608.377, 86.33448],
                [5791.495, 86.13587],
                [5980.5923, 85.93446],
                [6175.8633, 85.73038],
                [6377.5103, 85.52364],
                [6585.741, 85.31418],
                [6800.771, 85.101845],
                [7022.8213, 84.886444],
                [7252.122, 84.667755],
                [7488.9097, 84.44559],
                [7733.4287, 84.21982],
                [7985.9316, 83.99043],
                [8246.679, 83.757576],
                [8515.939, 83.52151],
                [8793.991, 83.28263],
                [9081.122, 83.04142],
                [9377.629, 82.79837],
                [9683.815, 82.55387],
                [10000, 82.30819],
            ],
            "fr" => [
                [101.07673, 0],
                [101.07673, 200],
                [4932.002, 200],
                [4932.002, 0],
            ],
        ],
        
    ],
];

        return json_encode($arrayVar, true);*/
        //var_dump($_REQUEST);
    }
    
    public function actionIndex1()
    {
        return $this->render('index');
        //return $this->redirect(['links/index']);
        // $this->redirect(['results/calculate']);
    }
    
    /**
     * Logs in a user.
     *
     * @return mixed
     */
    public function actionLogin()
    {
        $this->layout = 'blank';
        if (!Yii::$app->user->isGuest) {
            return $this->goHome();
        }
        
        $model = new LoginForm();
        if ($model->load(Yii::$app->request->post()) && $model->login()) {
            return $this->goBack();
        }

        $model->password = '';

        return $this->render('login', ['model' => $model]);
    }

    /**
     * Logs out the current user.
     *
     * @return mixed
     */
    public function actionLogout()
    {
        $this->layout = 'blank';
        Yii::$app->user->logout();

        return $this->goHome();
    }

    /**
     * Displays contact page.
     *
     * @return mixed
     */
    public function actionContact()
    {
        $model = new ContactForm();
        if ($model->load(Yii::$app->request->post()) && $model->validate()) {
            if ($model->sendEmail(Yii::$app->params['adminEmail'])) {
                Yii::$app->session->setFlash('success', 'Thank you for contacting us. We will respond to you as soon as possible.');
            } else {
                Yii::$app->session->setFlash('error', 'There was an error sending your message.');
            }

            return $this->refresh();
        }

        return $this->render('contact', [
            'model' => $model,
        ]);
    }

    /**
     * Displays about page.
     *
     * @return mixed
     */
    public function actionAbout()
    {
        return $this->render('about');
    }
    
    public function actionSupport()
    {
        return $this->render('support');
    }


    /**
     * Signs user up.
     *
     * @return mixed
     */
    public function actionSignup()
    {
        $this->layout = 'blank';
        $model = new SignupForm();
        if ($model->load(Yii::$app->request->post()) && $model->signup()) {
            Yii::$app->session->setFlash('success', 'Thank you for registration. Please check your inbox for verification email.');
            return $this->goHome();
        }

        return $this->render('signup', [
            'model' => $model,
        ]);
    }

    /**
     * Requests password reset.
     *
     * @return mixed
     */
    public function actionRequestPasswordReset()
    {
        $this->layout = 'blank';
        $model = new PasswordResetRequestForm();
        if ($model->load(Yii::$app->request->post()) && $model->validate()) {
            if ($model->sendEmail()) {
                Yii::$app->session->setFlash('success', 'Check your email for further instructions.');

                return $this->goHome();
            }

            Yii::$app->session->setFlash('error', 'Sorry, we are unable to reset password for the provided email address.');
        }

        return $this->render('requestPasswordResetToken', [
            'model' => $model,
        ]);
    }

    /**
     * Resets password.
     *
     * @param string $token
     * @return mixed
     * @throws BadRequestHttpException
     */
    public function actionResetPassword($token)
    {
        try {
            $model = new ResetPasswordForm($token);
        } catch (InvalidArgumentException $e) {
            throw new BadRequestHttpException($e->getMessage());
        }

        if ($model->load(Yii::$app->request->post()) && $model->validate() && $model->resetPassword()) {
            Yii::$app->session->setFlash('success', 'New password saved.');

            return $this->goHome();
        }
        $this->layout = 'blank';

        return $this->render('resetPassword', [
            'model' => $model,
        ]);
    }

    /**
     * Verify email address
     *
     * @param string $token
     * @throws BadRequestHttpException
     * @return yii\web\Response
     */
    public function actionVerifyEmail($token)
    {
        try {
            $model = new VerifyEmailForm($token);
        } catch (InvalidArgumentException $e) {
            throw new BadRequestHttpException($e->getMessage());
        }
        if (($user = $model->verifyEmail()) && Yii::$app->user->login($user)) {
            Yii::$app->session->setFlash('success', 'Your email has been confirmed!');
            return $this->goHome();
        }

        Yii::$app->session->setFlash('error', 'Sorry, we are unable to verify your account with provided token.');
        return $this->goHome();
    }

    /**
     * Resend verification email
     *
     * @return mixed
     */
    public function actionResendVerificationEmail()
    {
        $this->layout = 'blank';
        $model = new ResendVerificationEmailForm();
        if ($model->load(Yii::$app->request->post()) && $model->validate()) {
            if ($model->sendEmail()) {
                Yii::$app->session->setFlash('success', 'Check your email for further instructions.');
                return $this->goHome();
            }
            Yii::$app->session->setFlash('error', 'Sorry, we are unable to resend verification email for the provided email address.');
        }

        return $this->render('resendVerificationEmail', [
            'model' => $model
        ]);
    }
}
